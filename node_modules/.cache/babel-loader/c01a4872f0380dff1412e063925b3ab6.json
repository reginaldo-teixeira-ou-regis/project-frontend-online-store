{"ast":null,"code":"var _jsxFileName = \"/home/reginaldoteixeira/github-directory/github-project-trybe/project-frontend-online-store/src/pages/ProductList.jsx\";\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport { getCategories, getProductsFromCategoryAndQuery } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class ProductList extends Component {\n  constructor() {\n    var _this;\n\n    super(...arguments);\n    _this = this;\n    this.state = {\n      isEmpty: true,\n      categories: [],\n      category: '',\n      inputSearch: '',\n      products: '',\n      isSearched: false,\n      totalItems: 0,\n      cartItems: localStorage.cartItems ? JSON.parse(localStorage.cartItems) : []\n    };\n\n    this.handleChange = function (_ref) {\n      let {\n        target\n      } = _ref;\n      let callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : () => {};\n      const {\n        name,\n        value\n      } = target;\n\n      _this.setState({\n        [name]: value\n      }, callback);\n    };\n\n    this.handleProductsExhibition = async () => {\n      const {\n        inputSearch,\n        category\n      } = this.state;\n      const responseAPI = await getProductsFromCategoryAndQuery(category, inputSearch);\n      this.setState({\n        isEmpty: false,\n        products: responseAPI.results,\n        isSearched: true\n      });\n    };\n\n    this.loadCategories = () => {\n      getCategories().then(data => this.setState({\n        categories: data\n      }));\n    };\n\n    this.saveCartItem = _ref2 => {\n      let {\n        target\n      } = _ref2;\n      const {\n        products,\n        cartItems\n      } = this.state;\n      const getItem = products.find(item => item.id === target.id);\n      const hadItem = cartItems.some(item => item.id === getItem.id);\n\n      if (!hadItem) {\n        getItem.quantity = 1;\n        cartItems.push(getItem);\n        localStorage.cartItems = JSON.stringify(cartItems);\n        this.setState({\n          cartItems\n        });\n      } else {\n        cartItems.forEach(item => {\n          if (item.id === target.id && item.quantity < item.available_quantity) {\n            item.quantity += 1;\n          }\n        });\n        localStorage.cartItems = JSON.stringify(cartItems);\n        this.setState({\n          cartItems\n        });\n      }\n\n      this.countCartItems();\n    };\n\n    this.countCartItems = () => {\n      var _cartItems$reduce;\n\n      const {\n        cartItems\n      } = this.state;\n      const totalItems = (_cartItems$reduce = cartItems.reduce((total, _ref3) => {\n        let {\n          quantity\n        } = _ref3;\n        return total + quantity;\n      }, 0)) !== null && _cartItems$reduce !== void 0 ? _cartItems$reduce : 0;\n      this.setState({\n        totalItems\n      });\n      localStorage.totalItems = totalItems;\n    };\n  }\n\n  componentDidMount() {\n    this.loadCategories();\n    this.countCartItems();\n  }\n\n  render() {\n    const {\n      isEmpty,\n      categories,\n      products,\n      isSearched,\n      inputSearch,\n      totalItems\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        to: \"/shopping-cart\",\n        \"data-testid\": \"shopping-cart-button\",\n        children: \"Carrinho de Compra\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        \"data-testid\": \"shopping-cart-size\",\n        children: totalItems\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        \"data-testid\": \"query-input\",\n        name: \"inputSearch\",\n        value: inputSearch,\n        type: \"text\",\n        onChange: this.handleChange,\n        placeholder: \"Digite aqui\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        \"data-testid\": \"query-button\",\n        type: \"button\",\n        onClick: this.handleProductsExhibition,\n        children: \"Salvar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this), categories.map(_ref4 => {\n        let {\n          id,\n          name\n        } = _ref4;\n        return /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: id,\n          \"data-testid\": \"category\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            name: \"category\",\n            id: id,\n            value: id,\n            onChange: event => this.handleChange(event, this.handleProductsExhibition)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 15\n          }, this), name]\n        }, id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 13\n        }, this);\n      }), isEmpty && /*#__PURE__*/_jsxDEV(\"p\", {\n        \"data-testid\": \"home-initial-message\",\n        children: \"Digite algum termo de pesquisa ou escolha uma categoria.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 13\n      }, this), isSearched && (products.length > 0 ? products.map(_ref5 => {\n        let {\n          id,\n          title,\n          thumbnail,\n          price,\n          shipping: {\n            free_shipping: freeShipping\n          }\n        } = _ref5;\n        return (\n          /*#__PURE__*/\n          // Coloquei Link dentro de uma div afim de inserir um botão de adicionar ao carrinho\n          // O atributo Key foi realocado para a div pai pois não há necessidade de mantê-lá duplicada\n          // Coloquei div de produtos em Link\n          _jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(Link, {\n              \"data-testid\": \"product-detail-link\",\n              to: `/items/${id}`,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                \"data-testid\": \"product\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 154,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: thumbnail,\n                  alt: title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 155,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: price\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 21\n                }, this), freeShipping && /*#__PURE__*/_jsxDEV(\"p\", {\n                  \"data-testid\": \"free-shipping\",\n                  children: \"Frete gratis\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 157,\n                  columnNumber: 39\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              \"data-testid\": \"product-add-to-cart\",\n              type: \"button\",\n              id: id,\n              onClick: this.saveCartItem,\n              children: \"Adicionar ao carrinho\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 17\n            }, this)]\n          }, id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 15\n          }, this)\n        );\n      }) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Nenhum produto foi encontrado\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 13\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"names":["React","Component","Link","getCategories","getProductsFromCategoryAndQuery","ProductList","state","isEmpty","categories","category","inputSearch","products","isSearched","totalItems","cartItems","localStorage","JSON","parse","handleChange","target","callback","name","value","setState","handleProductsExhibition","responseAPI","results","loadCategories","then","data","saveCartItem","getItem","find","item","id","hadItem","some","quantity","push","stringify","forEach","available_quantity","countCartItems","reduce","total","componentDidMount","render","map","event","length","title","thumbnail","price","shipping","free_shipping","freeShipping"],"sources":["/home/reginaldoteixeira/github-directory/github-project-trybe/project-frontend-online-store/src/pages/ProductList.jsx"],"sourcesContent":["import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport { getCategories, getProductsFromCategoryAndQuery } from '../services/api';\n\nexport default class ProductList extends Component {\n  state = {\n    isEmpty: true,\n    categories: [],\n    category: '',\n    inputSearch: '',\n    products: '',\n    isSearched: false,\n    totalItems: 0,\n    cartItems: localStorage.cartItems\n      ? JSON.parse(localStorage.cartItems)\n      : [],\n  };\n\n  componentDidMount() {\n    this.loadCategories();\n    this.countCartItems();\n  }\n\n  handleChange = ({ target }, callback = () => {}) => {\n    const { name, value } = target;\n    this.setState({\n      [name]: value,\n    }, callback);\n  };\n\n  handleProductsExhibition = async () => {\n    const { inputSearch, category } = this.state;\n    const responseAPI = await getProductsFromCategoryAndQuery(category, inputSearch);\n    this.setState({\n      isEmpty: false,\n      products: responseAPI.results,\n      isSearched: true,\n    });\n  };\n\n  loadCategories = () => {\n    getCategories().then((data) => this.setState({\n      categories: data,\n    }));\n  };\n\n  saveCartItem = ({ target }) => {\n    const { products, cartItems } = this.state;\n    const getItem = products.find((item) => item.id === target.id);\n    const hadItem = cartItems.some((item) => item.id === getItem.id);\n    if (!hadItem) {\n      getItem.quantity = 1;\n      cartItems.push(getItem);\n      localStorage.cartItems = JSON.stringify(cartItems);\n      this.setState({ cartItems });\n    } else {\n      cartItems.forEach((item) => {\n        if (item.id === target.id && item.quantity < item.available_quantity) {\n          item.quantity += 1;\n        }\n      });\n      localStorage.cartItems = JSON.stringify(cartItems);\n      this.setState({ cartItems });\n    }\n    this.countCartItems();\n  };\n\n  countCartItems = () => {\n    const { cartItems } = this.state;\n    const totalItems = cartItems\n      .reduce((total, { quantity }) => total + quantity, 0) ?? 0;\n    this.setState({ totalItems });\n    localStorage.totalItems = totalItems;\n  };\n\n  render() {\n    const {\n      isEmpty,\n      categories,\n      products,\n      isSearched,\n      inputSearch,\n      totalItems,\n    } = this.state;\n    return (\n      <div>\n        <Link to=\"/shopping-cart\" data-testid=\"shopping-cart-button\">\n          Carrinho de Compra\n        </Link>\n        <p data-testid=\"shopping-cart-size\">\n          {totalItems}\n        </p>\n        <input\n          data-testid=\"query-input\"\n          name=\"inputSearch\"\n          value={ inputSearch }\n          type=\"text\"\n          onChange={ this.handleChange }\n          placeholder=\"Digite aqui\"\n        />\n        <button\n          data-testid=\"query-button\"\n          type=\"button\"\n          onClick={ this.handleProductsExhibition }\n        >\n          Salvar\n        </button>\n        {\n          categories.map(({ id, name }) => (\n            <label\n              htmlFor={ id }\n              key={ id }\n              data-testid=\"category\"\n            >\n              <input\n                type=\"radio\"\n                name=\"category\"\n                id={ id }\n                value={ id }\n                onChange={ (event) => (\n                  this.handleChange(event, this.handleProductsExhibition)\n                ) }\n              />\n              { name }\n            </label>\n          ))\n        }\n        {isEmpty\n          && (\n            <p data-testid=\"home-initial-message\">\n              Digite algum termo de pesquisa ou escolha uma categoria.\n            </p>\n          )}\n        {isSearched && ((products.length > 0)\n          ? (\n            products.map(({\n              id,\n              title,\n              thumbnail,\n              price,\n              shipping: { free_shipping: freeShipping },\n            }) => (\n              // Coloquei Link dentro de uma div afim de inserir um botão de adicionar ao carrinho\n              // O atributo Key foi realocado para a div pai pois não há necessidade de mantê-lá duplicada\n              // Coloquei div de produtos em Link\n              <div key={ id }>\n                <Link\n                  data-testid=\"product-detail-link\"\n                  to={ `/items/${id}` }\n                >\n                  <div\n                    data-testid=\"product\"\n                  >\n                    <h3>{ title }</h3>\n                    <img src={ thumbnail } alt={ title } />\n                    <p>{ price }</p>\n                    { freeShipping && <p data-testid=\"free-shipping\">Frete gratis</p> }\n                  </div>\n                </Link>\n                <button\n                  data-testid=\"product-add-to-cart\"\n                  type=\"button\"\n                  id={ id }\n                  onClick={ this.saveCartItem }\n                >\n                  Adicionar ao carrinho\n                </button>\n              </div>\n            ))\n          )\n          : (\n            <p>\n              Nenhum produto foi encontrado\n            </p>\n          ))}\n      </div>\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}